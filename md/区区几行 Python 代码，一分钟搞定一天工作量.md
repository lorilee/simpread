
ä½œè€… | é™ˆç†¹ã€åˆ˜æ—©èµ·  

æ¥æº | æ—©èµ· Python

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ—©èµ·ã€‚

å‰å‡ å¤©æœ‰ä¸€ä¸ªè¯»è€…è¯´æœ€è¿‘è¦æ•´ç†å‡ åƒä»½æ–‡ä»¶ï¼Œå¤´éƒ½è¦æ•´ç§ƒäº†ï¼Œä¸çŸ¥é“èƒ½ä¸èƒ½ç”¨ Python è§£å†³ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥æ€è€ƒä¸€ä¸‹ã€‚

> ç”±äºæ¶‰åŠæ–‡ä»¶ç§å¯†æ‰€ä»¥å…·ä½“å†…å®¹å·²åšè„±æ•å¤„ç†ã€‚

å¤§æ¦‚æ˜¯è¿™æ ·ï¼Œä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹æœ‰å¤šä»½ä¼šè®®é€šçŸ¥ä¿¡æ¯ï¼ˆæœ¬æ–‡ä»¥ 7 ä»½æ–‡ä»¶ä¸ºä¾‹ï¼‰

![](https://mmbiz.qpic.cn/mmbiz_png/2GcSFhuAFlAWetCrA14MwicibqNG2EfNyItZwWvocjzXcic8lyUwAYPIPHBqqfefcWvr4uQB3IiaNlUE8d2lWNGedw/640?wx_fmt=png)

æ¯ä¸€ä»½é€šçŸ¥æ‰“å¼€æ ¼å¼åŸºæœ¬ç±»ä¼¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºğŸ‘‡

![](https://mmbiz.qpic.cn/mmbiz_png/2GcSFhuAFlAWetCrA14MwicibqNG2EfNyISA0SgqZOyjvlm6Zq9mJqQpt3q0cV4zZwgibsq4ATkFxXrg5SwbnP3CQ/640?wx_fmt=png)

ç°åœ¨éœ€è¦å°†æ¯ä»½ä¼šè®®æ–‡æ¡£ä¸­çš„ å­¦ä¹ æ—¶é—´ã€å­¦ä¹ å†…å®¹ã€å­¦ä¹ å½¢å¼ã€ä¸»æŒäºº å››é¡¹å…³é”®ä¿¡æ¯æå–å‡ºæ¥ï¼Œæ•´ç†åˆ° Excel è¡¨æ ¼ä¸­ï¼š

![](https://mmbiz.qpic.cn/mmbiz_png/2GcSFhuAFlAWetCrA14MwicibqNG2EfNyIO6UpqmmvsBjJbabBDVwY3l5KZzYYW9sjO5h0nic66hV7t6TTkibOQO2A/640?wx_fmt=png)

åœ¨ä»–çœŸå®éœ€æ±‚ä¸­ï¼Œä¼šè®®é€šçŸ¥å››å¹´ç§¯ç´¯ä¸‹æ¥æœ‰å¿« 1000 ä»½ï¼ˆå››å¹´å¼€äº†è¿™ä¹ˆå¤šæ¬¡ä¼šä¹Ÿæ˜¯å¾ˆå‰å®³...ï¼‰ï¼Œç”¨äººåŠ›æŒ¨ä¸ªæ‰“å¼€æ–‡ä»¶å¹¶å½•åˆ° Excel ä¸­å·¥ä½œé‡å®åœ¨å¤ªå¤§ã€‚

å¥½å®¶ä¼™ï¼Œè¿™ç§**é‡å¤çš„æ— èŠå·¥ä½œ**ï¼Œä¸å°±æ˜¯ä¸€ä»½éå¸¸é€‚åˆäº¤ç»™ Python çš„è‡ªåŠ¨åŒ–å·¥ä½œå—ï¼Ÿ

ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç”¨ Python è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸»è¦å°†æ¶‰åŠï¼š

*   openpyxlÂ å†™å…¥ Excel æ–‡ä»¶
    
*   python-docxÂ è¯»å– Word æ–‡ä»¶
    
*   globÂ æ‰¹é‡è·å–æ–‡ä»¶è·¯å¾„
    

ä¸ºäº†ç®€åŒ–ä¸Šé¢çš„éœ€æ±‚ï¼Œæœ¬æ–‡ä¸­éœ€è¦è·å–çš„ä¼šè®®é€šçŸ¥æ–‡ä»¶ä¸€å…± 7 ä¸ªï¼Œåˆ†åˆ«å‘½åä¸ºÂ ä¼šè®®é€šçŸ¥ 1.docxã€ä¼šè®®é€šçŸ¥ 2.docx... ä¼šè®®é€šçŸ¥ 7.docxï¼Œå­˜æ”¾åœ¨ Notice æ–‡ä»¶å¤¹ä¸‹ã€‚è¾“å‡ºçš„ç›®æ ‡ Excel æ–‡ä»¶å‘½åä¸º Meeting_temp.xlsx

**åŸºæœ¬é€»è¾‘**
--------

å†™ä»£ç ä¹‹å‰éƒ½å…ˆ**æ˜ç¡®å®Œæ•´çš„é—®é¢˜éœ€è¦åˆ†ä¸ºå‡ ä¸ªå°æ­¥éª¤å®ç°**ã€‚ä»éœ€æ±‚ä¸­æˆ‘ä»¬å¤§æ¦‚å¯ä»¥å°†ä»£ç åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

*   è·å–ä¼šè®®é€šçŸ¥ Notice æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼›
    
*   è§£ææ¯ä¸€ä»½ Word æ–‡ä»¶ï¼Œè·å–éœ€è¦çš„å››ä¸ªä¿¡æ¯ï¼Œè¾“å‡ºåˆ° Excel ä¸­ï¼›
    
*   ä¿å­˜ Excel æ–‡ä»¶
    

æœ‰äº†é€»è¾‘å°±æœ‰äº†å†™ä»£ç çš„æ€è·¯äº†ã€‚ç¬¬ 1 æ­¥å¯ä»¥ç”± glob åº“å®Œæˆï¼Œåé¢ä¸¤æ­¥å°±æ˜¯æ“ä½œ Word çš„ python-docx åº“å’Œæ“ä½œ Excel çš„ openpyxl åº“çš„äº¤äº’åä½œäº†ã€‚

è¿™ä¸¤ä¸ªåº“æˆ‘ä»¬éƒ½æœ‰è¯´è¿‡ï¼Œå¦‚æœä½ ä¸ç†Ÿæ‚‰ï¼Œä¸€å®šè¦å…ˆé˜…è¯»ä¸‹é¢çš„æ–‡ç« ï¼

*   [ğŸ‘‰python-docx æ“ä½œ Word è¯¦è§£](https://mp.weixin.qq.com/s?__biz=MzI1MTUyMjc1Mg==&mid=2247503940&idx=1&sn=41e2e99a075f3104402711fdef87c099&scene=21#wechat_redirect)
    
*   [ğŸ‘‰openpyxl æ“ä½œ Excel è¯¦è§£](https://mp.weixin.qq.com/s?__biz=MzI1MTUyMjc1Mg==&mid=2247500234&idx=1&sn=5d2a216d1b064102a96123440c95e0fd&scene=21#wechat_redirect)
    

**ä»£ç å®ç°**
--------

é¦–å…ˆå¯¼å…¥éœ€è¦çš„åº“ï¼š

```
1fromÂ docxÂ importÂ Document
2fromÂ openpyxlÂ importÂ load_workbook
3importÂ glob
å°†æ¨¡æ¿ Excel è¯»å–è¿›ç¨‹åºï¼š
```

```
1pathÂ Â =Â r'C:\Users\xxx'Â #Â è·¯å¾„ä¸ºä¼šè®®é€šçŸ¥æ–‡ä»¶å¤¹å’ŒÂ ExcelÂ æ¨¡æ¿æ‰€åœ¨çš„ä½ç½®ï¼Œå¯æŒ‰å®é™…æƒ…å†µæ›´æ”¹
2workbookÂ =Â load_workbook(pathÂ +Â r'\Meeting_temp.xlsx')
3sheetÂ =Â workbook.active

å†™ä»»ä½•æ‰¹å¤„ç†çš„ä»£ç ä¹‹å‰éƒ½å»ºè®®å…ˆå†™ä¸€ä¸‹å•æ¬¡æ“ä½œçš„ä»£ç ï¼Œå› æ­¤æˆ‘ä»¬å…ˆå®Œæˆå¯¹ ä¼šè®®é€šçŸ¥ 1.docx æ–‡ä»¶çš„è§£æï¼Œç¡®ä¿æ— è¯¯ã€‚ç°åœ¨å¯¹äºæ–‡æ¡£çš„ç»“æ„å’Œå…³é”®ä¿¡æ¯çš„ä½ç½®å°šä¸æ˜ç¡®ï¼Œå¯ä»¥å…ˆå°† Word ä»¥æ®µè½ Paragraph ä¸ºå•ä½è¾“å‡ºè§‚å¯Ÿï¼š
```

```
1wordfileÂ =Â Document(pathÂ +Â r'\Notice\ä¼šè®®é€šçŸ¥Â 1.docx')
2forÂ paragraphÂ inÂ wordfile.paragraphs:
3Â Â Â Â print(paragraph)
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/VeJKXItpwPXWLpENCwyR2GLh1A8ztFHTjCo6nflicA5u2vVQoiaFCtIibe8sHu2uxYP7QurNiazicI61KkH49y5IL5w/640?wx_fmt=jpeg)

æ–‡ä»¶çš„æ–‡å­—æ’å¸ƒè„‰ç»œæ¯”è¾ƒæ¸…æ™°ï¼ŒåŸºæœ¬æ˜¯ä¸€å¥è¯å¯¹åº”ä¸€ä¸ªæ®µè½ï¼Œè€Œéœ€è¦çš„ä¿¡æ¯å¯ä»¥ç®€å•é€šè¿‡åˆ¤æ–­æ¯å¥è¯ï¼ˆæ¯æ®µè¯ï¼‰å‰å‡ ä¸ªå­—è€Œæ˜ç¡®ï¼š

```
1forÂ paragraphÂ inÂ wordfile.paragraphs:
2Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ æ—¶é—´ï¼š':
3Â Â Â Â Â Â Â Â Â Â Â Â study_timeÂ =Â paragraph.text[5:]
4Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:4]Â ==Â 'ä¸»æŒäººï¼š':
5Â Â Â Â Â Â Â Â Â Â Â Â hostÂ =Â paragraph.text[4:]
6Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ å½¢å¼ï¼š':
7Â Â Â Â Â Â Â Â Â Â Â Â study_typeÂ =Â paragraph.text[5:]

å¯¹äºå­¦ä¹ å†…å®¹çš„è·å–æ¯”è¾ƒç‰¹æ®Šï¼Œä¸åƒå…¶ä»–ä¸‰ä¸ªä¿¡æ¯ï¼Œéƒ½åœ¨ä¸€å¥è¯ä¸­ï¼Œä¸”å…³é”®å­—å°±ä¸ºå‰å‡ ä¸ªå­—ï¼š
```

![](https://mmbiz.qpic.cn/mmbiz_jpg/2GcSFhuAFlDSCRiblfVbaejgxvicQmRSoVibggmOEfstNNzWf5YWMT3mmSztWTtbp8MJ9rJ3ZjY5RibWce9tQNiahEg/640?wx_fmt=jpeg)

å¯ä»¥çœ‹åˆ°ï¼Œâ€œå­¦ä¹ å†…å®¹â€ å››ä¸ªå­—å’ŒçœŸæ­£åŒ…å«çš„å†…å®¹åˆ†æ•£åœ¨ä¸åŒçš„å¥å­ä¸­. è¿™é‡Œç®€å•ç”¨ä¸€ä¸ªç­–ç•¥ï¼š

å»ºç«‹ä¸€ä¸ªç©ºåˆ—è¡¨å­˜æ”¾ï¼Œç„¶åéå†æ¯ä¸€æ®µåˆ¤æ–­ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦ä¸ºæ•°å­—ä¸”ç¬¬äºŒä¸ªå­—ç¬¦ä¸ºä¸­æ–‡é¡¿å·Â â€œã€â€Â å°±è·å–å­˜æ”¾åˆ°åˆ—è¡¨ä¸­ã€‚æœ€åæŠŠåˆ—è¡¨ä¸­çš„å…ƒç´ é‡æ–°ç»„åˆæˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²å³å¯ï¼š

```
1content_lstÂ =Â []
 2Â Â Â Â forÂ paragraphÂ inÂ wordfile.paragraphs:
 3Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ æ—¶é—´ï¼š':
 4Â Â Â Â Â Â Â Â Â Â Â Â study_timeÂ =Â paragraph.text[5:]
 5Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:4]Â ==Â 'ä¸»æŒäººï¼š':
 6Â Â Â Â Â Â Â Â Â Â Â Â hostÂ =Â paragraph.text[4:]
 7Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ å½¢å¼ï¼š':
 8Â Â Â Â Â Â Â Â Â Â Â Â study_typeÂ =Â paragraph.text[5:]
 9Â Â Â Â Â Â Â Â ifÂ len(paragraph.text)Â >=Â 2:
10Â Â Â Â Â Â Â Â Â Â Â Â ifÂ paragraph.text[0].isdigit()Â andÂ paragraph.text[1]Â ==Â 'ã€':
11Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â content_lst.append(paragraph.text)
12Â Â Â Â contentÂ =Â 'Â '.join(content_lst)

å®Œæˆäº†è§£æ Word æ–‡ä»¶ä¹‹åï¼Œå°±éœ€è¦æŠŠå†…å®¹è¾“å‡ºçš„ Excel æ–‡ä»¶ä¸­äº†ã€‚
```

ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†ä¸Šé¢ä»£ç è·å–åˆ°çš„å‡ ä¸ªå…ƒç´ ç»„åˆæˆä¸€ä¸ªåˆ—è¡¨ï¼Œé€šè¿‡ sheet.append(list)Â çš„æ–¹æ³•å†™å…¥ Excel æ–‡ä»¶ä¸­ï¼š

```
1numberÂ =Â 0Â #Â å…¨å±€ä¸­è®¾ç½®ä¸€ä¸ªå˜é‡ç”¨äºè®¡æ•°ï¼Œåšä¸ºåºå·è¾“å‡º
 3wordfileÂ =Â Document(pathÂ +Â r'\Notice\ä¼šè®®é€šçŸ¥Â 1.docx')
 4content_lstÂ =Â []
 5forÂ paragraphÂ inÂ wordfile.paragraphs:
 6Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ æ—¶é—´ï¼š':
 7Â Â Â Â Â Â Â Â study_timeÂ =Â paragraph.text[5:]
 8Â Â Â Â ifÂ paragraph.text[0:4]Â ==Â 'ä¸»æŒäººï¼š':
 9Â Â Â Â Â Â Â Â hostÂ =Â paragraph.text[4:]
10Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ å½¢å¼ï¼š':
11Â Â Â Â Â Â Â Â study_typeÂ =Â paragraph.text[5:]
12Â Â Â Â ifÂ len(paragraph.text)Â >=Â 2:
13Â Â Â Â Â Â Â Â ifÂ paragraph.text[0].isdigit()Â andÂ paragraph.text[1]Â ==Â 'ã€':
14Â Â Â Â Â Â Â Â Â Â Â Â content_lst.append(paragraph.text)
15contentÂ =Â 'Â '.join(content_lst)
16numberÂ +=Â 1
17sheet.append([number,Â study_time,Â content,Â study_type,Â host])

å•ä¸ªæ–‡ä»¶è§£æå®Œï¼Œç”¨ glob æ”¹å®Œè·å–æ–‡ä»¶å¤¹ä¸‹å…¨éƒ¨æ–‡ä»¶ï¼Œå»ºç«‹å¾ªç¯é€ä¸ªè§£æå°±èƒ½å®Œæˆæœ¬éœ€æ±‚ï¼Œå½“ç„¶æœ€åè®°å¾—ä¿å­˜ Excel æ–‡ä»¶ã€‚
```

å®Œæ•´ä»£ç å¦‚ä¸‹ğŸ‘‡

```
1fromÂ docxÂ importÂ Document
 2fromÂ openpyxlÂ importÂ load_workbook
 3importÂ glob
 5pathÂ Â =Â r'C:\Users\xxx'
 6workbookÂ =Â load_workbook(pathÂ +Â r'\Meeting_temp.xlsx')
 7sheetÂ =Â workbook.active
 8numberÂ =Â 0
10forÂ fileÂ inÂ glob.glob(pathÂ +Â r'\Notice\*.docx'):
11Â Â Â Â wordfileÂ =Â Document(file)
12Â Â Â Â content_lstÂ =Â []
13Â Â Â Â forÂ paragraphÂ inÂ wordfile.paragraphs:
14Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ æ—¶é—´ï¼š':
15Â Â Â Â Â Â Â Â Â Â Â Â study_timeÂ =Â paragraph.text[5:]
16Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:4]Â ==Â 'ä¸»æŒäººï¼š':
17Â Â Â Â Â Â Â Â Â Â Â Â hostÂ =Â paragraph.text[4:]
18Â Â Â Â Â Â Â Â ifÂ paragraph.text[0:5]Â ==Â 'å­¦ä¹ å½¢å¼ï¼š':
19Â Â Â Â Â Â Â Â Â Â Â Â study_typeÂ =Â paragraph.text[5:]
20Â Â Â Â Â Â Â Â ifÂ len(paragraph.text)Â >=Â 2:
21Â Â Â Â Â Â Â Â Â Â Â Â ifÂ paragraph.text[0].isdigit()Â andÂ paragraph.text[1]Â ==Â 'ã€':
22Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â content_lst.append(paragraph.text)
23Â Â Â Â contentÂ =Â 'Â '.join(content_lst)
24Â Â Â Â numberÂ +=Â 1
25Â Â Â Â sheet.append([number,Â study_time,Â content,Â study_type,Â host])
27workbook.save(pathÂ +Â r'\Meeting_notice.xlsx')
```

æ ¸å¿ƒä¹Ÿä¸è¿‡ä¸‰åè¡Œä»£ç ï¼Œæ€»å…±ä¸è¿‡ä¸‰ç§’å°±æå®šäº†ï¼

å¦‚æœä½ ä¹Ÿæƒ³è¯•è¯•ï¼Œå¯ä»¥å°è¯•ç”¨æ–‡ä¸­çš„ä»£ç å®ç°ï¼Œç»ƒä¹ æ•°æ®ï¼š

https://pan.baidu.com/s/1H3x16tYAqqaEamw4fdzlrwï¼ˆæå–ç ï¼š86vcï¼‰

![](https://mmbiz.qpic.cn/mmbiz_jpg/Pn4Sm0RsAuggpZ0lia5ZjmiaqEIGqmY9Ch46r8l3Cv9Lvuqq7ic7xlHVf7zNlwgiaYRMdLib25h7pMEunOCf4IwibDRw/640?wx_fmt=jpeg)

```
æ›´å¤šç²¾å½©æ¨è
```

```
â˜è¯»æ‡‚æ·±åº¦è¿ç§»å­¦ä¹ ï¼Œçœ‹è¿™æ–‡å°±å¤Ÿäº† | èµ ä¹¦
â˜ã€å¸¦ä½ å­¦AIã€ä¸€æ–‡å¸¦ä½ ææ‡‚OCRè¯†åˆ«ç®—æ³•CRNNï¼šè§£æ+æºç 
â˜é¾™æ³‰å¯ºè´¤è¶…æ³•å¸ˆï¼šç”¨ AI ä¸ºå¤ç±ç»ä¹¦è¯†åˆ«ã€æ–­å¥ã€ç¿»è¯‘
â˜å¾®ä¿¡åå‘¨å¹´ï¼Œè…¾è®¯æ™’æˆç»©å•äº†ï¼
```

```
ç‚¹åˆ†äº«
ç‚¹æ”¶è—
ç‚¹ç‚¹èµ
ç‚¹åœ¨çœ‹
```
